<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ù…Ø²ÙˆÙ† Ú©ÛŒÙ…ÛŒØ§</title>
<style>
:root{--accent:#d63384;--muted:#666}
*{box-sizing:border-box;font-family:Tahoma, sans-serif}
body{margin:0;background:#f6f7fb;color:#222}
header{background:white;padding:18px 24px;display:flex;align-items:center;justify-content:space-between;gap:12px;box-shadow:0 1px 6px rgba(10,10,10,0.06)}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:54px;height:54px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#6f42c1);display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
.title{font-size:18px}
.controls{display:flex;gap:8px;align-items:center}
input[type="search"], select{padding:10px 12px;border-radius:8px;border:1px solid #e0e0e6;background:white}
button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer}
main{padding:20px;max-width:1150px;margin:18px auto}
.grid{display:grid;grid-template-columns:1fr 320px;gap:18px}
.products{background:white;padding:14px;border-radius:12px;min-height:320px}
.side{background:white;padding:14px;border-radius:12px}
.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
.card{border:1px solid #eee;border-radius:10px;padding:10px;background:#fff;display:flex;flex-direction:column;gap:8px}
.img{height:160px;background:#f2f2f6;border-radius:8px;display:flex;align-items:center;justify-content:center;color:var(--muted)}
.price{color:var(--accent);font-weight:700}
.meta{font-size:13px;color:var(--muted)}
footer{max-width:1150px;margin:18px auto;text-align:center;color:#777}
.admin-area{display:flex;flex-direction:column;gap:10px}
label{font-size:13px;color:#333}
textarea, input[type=text], input[type=number]{width:100%;padding:8px;border-radius:8px;border:1px solid #e5e5ea}
.hidden{display:none}
.actions{display:flex;gap:8px}
.small{padding:6px 8px;font-size:13px;border-radius:8px}
@media (max-width:900px){.grid{grid-template-columns:1fr;}.controls{flex:1;justify-content:flex-end}}
</style>
</head>
<body>
<header>
  <div class="brand">
    <div>
      <div class="title">Ù…Ø²ÙˆÙ† Ú©ÛŒÙ…ÛŒØ§</div>
      <div style="font-size:12px;color:var(--muted)">ÙØ±ÙˆØ´ Ù„Ø¨Ø§Ø³ Ùˆ Ù¾Ø§Ø±Ú†Ù‡ </div>
    </div>
  </div>
  <div class="controls">
    <input id="search" type="search" placeholder="Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ..." />
    <select id="sort">
      <option value="newest">Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ†</option>
      <option value="price-asc">Ù‚ÛŒÙ…Øª: Ú©Ù… â†’ Ø²ÛŒØ§Ø¯</option>
      <option value="price-desc">Ù‚ÛŒÙ…Øª: Ø²ÛŒØ§Ø¯ â†’ Ú©Ù…</option>
    </select>
    <button onclick="location.href='cart.html'">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ ğŸ›’</button>
    <button id="loginBtn">ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±ÛŒØª</button>
  </div>
</header>

<main>
<div class="grid">
<section class="products">
<h3>Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ (<span id="count">0</span>)</h3>
<div id="cards" class="cards"></div>
<div id="emptyHint" style="text-align:center;color:var(--muted);padding:30px">ÙØ¹Ù„Ø§ Ø¢Ú¯Ù‡ÛŒâ€ŒØ§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</div>
</section>

<aside class="side">
<h4>ÙÛŒÙ„ØªØ±Ù‡Ø§</h4>
<label>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</label>
<select id="categoryFilter">
  <option value="all">Ù‡Ù…Ù‡</option>
  <option value="Ù„Ø¨Ø§Ø³">Ù„Ø¨Ø§Ø³</option>
  <option value="Ù¾Ø§Ø±Ú†Ù‡">Ù¾Ø§Ø±Ú†Ù‡</option>
  <option value="Ø§Ú©Ø³Ø³ÙˆØ±ÛŒ">Ø§Ú©Ø³Ø³ÙˆØ±ÛŒ</option>
</select>
<label>Ù‚ÛŒÙ…Øª ØªØ§ (ØªÙˆÙ…Ø§Ù†)</label>
<input id="priceMax" type="number" />
<button id="applyFilter" class="small">Ø§Ø¹Ù…Ø§Ù„</button>
<button id="clearFilter" class="small" style="background:#eee;color:#222">Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ</button>

<hr />
<div id="adminPanel">
<h4>Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ú¯Ù‡ÛŒ</h4>
<div id="notLogged" class="admin-area">
<button id="loginPanelBtn" class="small">ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±ÛŒØª</button>
</div>
<div id="logged" class="admin-area hidden">
<div style="font-size:13px;color:var(--muted)">ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø¨Ù‡â€ŒØ¹Ù†ÙˆØ§Ù† Ù…Ø¯ÛŒØ±</div>
<button id="logoutBtn" class="small" style="background:#f03d3d">Ø®Ø±ÙˆØ¬</button>
<button onclick="location.href='admin_orders.html'" class="small" style="background:#28a745">Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø´ØªØ±ÛŒØ§Ù†</button>
<hr />
<h5>Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ú¯Ù‡ÛŒ Ø¬Ø¯ÛŒØ¯</h5>
<label>Ø¹Ù†ÙˆØ§Ù†</label><input id="pTitle" type="text" />
<label>ØªÙˆØ¶ÛŒØ­Ø§Øª</label><textarea id="pDesc" rows="3"></textarea>
<label>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</label><select id="pCategory">
<option value="Ù„Ø¨Ø§Ø³">Ù„Ø¨Ø§Ø³</option>
<option value="Ù¾Ø§Ø±Ú†Ù‡">Ù¾Ø§Ø±Ú†Ù‡</option>
<option value="Ø§Ú©Ø³Ø³ÙˆØ±ÛŒ">Ø§Ú©Ø³Ø³ÙˆØ±ÛŒ</option>
</select>
<label>Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†)</label><input id="pPrice" type="number" />
<label>ØªØµØ§ÙˆÛŒØ± (Ú†Ù†Ø¯ ØªØµÙˆÛŒØ± Ø¨Ø§ Ctrl/Shift Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯)</label>
<input id="pImages" type="file" accept="image/*" multiple />
<label>Ø±Ù†Ú¯â€ŒÙ‡Ø§ (Ù…Ø«Ù„Ø§: Ù‚Ø±Ù…Ø²,Ø¢Ø¨ÛŒ,Ø³Ø¨Ø²)</label>
<input id="pColors" type="text" placeholder="Ù…Ø«Ù„Ø§ Ù‚Ø±Ù…Ø²,Ø¢Ø¨ÛŒ,Ø³Ø¨Ø²" />
<button id="addProduct" class="small">Ø§ÙØ²ÙˆØ¯Ù†</button>
</div>
</div>
</aside>
</div>
</main>

<footer> Ù…Ø¯ÛŒØ±ÛŒØª Ù‚Ø§Ø¯Ø± Ø¨Ù‡ Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ú¯Ù‡ÛŒ Ùˆ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ Ø§Ø³Øª.</footer>

<script>
const STORAGE_KEY='mezoun_kimia_products';
const ADMIN_PASSWORD='kimia123';

function isAdminLogged(){return sessionStorage.getItem('mk_admin')==='1'}
function setAdminLogged(v){v?sessionStorage.setItem('mk_admin','1'):sessionStorage.removeItem('mk_admin')}
function loadProducts(){return JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]')}
function saveProducts(l){localStorage.setItem(STORAGE_KEY,JSON.stringify(l))}

const cardsEl=document.getElementById('cards'),countEl=document.getElementById('count'),emptyHint=document.getElementById('emptyHint');

function renderProducts(list){
  cardsEl.innerHTML='';
  if(!list.length){emptyHint.style.display='block';countEl.textContent='0';return}
  emptyHint.style.display='none';countEl.textContent=list.length;
  list.forEach((p,i)=>{
    const c=document.createElement('div');c.className='card';
    const img=document.createElement('div');img.className='img';
    if(p.images && p.images.length){const im=new Image();im.src=p.images[0];im.style.maxWidth='100%';im.style.maxHeight='100%';img.appendChild(im)}
    else img.textContent='Ø¨Ø¯ÙˆÙ† ØªØµÙˆÛŒØ±';
    const title=document.createElement('div');title.innerHTML='<strong>'+p.title+'</strong>';
    const price=document.createElement('div');price.className='price';price.textContent=p.price+' ØªÙˆÙ…Ø§Ù†';
    const actions=document.createElement('div');actions.className='actions';
    const v=document.createElement('button');v.className='small';v.textContent='Ù†Ù…Ø§ÛŒØ´';v.onclick=()=>location.href='product.html?id='+i;actions.appendChild(v);
    if(isAdminLogged()){
      const del=document.createElement('button');del.className='small';del.textContent='Ø­Ø°Ù';del.style.background='#f66';
      del.onclick=()=>{let all=loadProducts();all.splice(i,1);saveProducts(all);applyFilters()};
      actions.appendChild(del)
    }
    c.append(img,title,price,actions);cardsEl.appendChild(c);
  })
}

function applyFilters(){
  let l=loadProducts();
  const q=document.getElementById('search').value.toLowerCase();
  const cat=document.getElementById('categoryFilter').value;
  const max=document.getElementById('priceMax').value;
  if(q) l=l.filter(p=>p.title.toLowerCase().includes(q)||p.desc.toLowerCase().includes(q));
  if(cat!=='all') l=l.filter(p=>p.category===cat);
  if(max) l=l.filter(p=>+p.price<=+max);
  const s=document.getElementById('sort').value;
  if(s==='price-asc') l.sort((a,b)=>a.price-b.price);
  else if(s==='price-desc') l.sort((a,b)=>b.price-a.price);
  else l.sort((a,b)=>b.createdAt-b.createdAt);
  renderProducts(l)
}

function showLogin(){
  const pass=prompt('Ø±Ù…Ø² Ù…Ø¯ÛŒØ±ÛŒØª:');
  if(pass===ADMIN_PASSWORD){setAdminLogged(true);updateAdmin();alert('ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚')}
  else alert('Ù†Ø§Ø¯Ø±Ø³Øª')
}

function updateAdmin(){
  document.getElementById('notLogged').classList.toggle('hidden',isAdminLogged());
  document.getElementById('logged').classList.toggle('hidden',!isAdminLogged());
  document.getElementById('loginBtn').textContent=isAdminLogged()?'Ù…Ø¯ÛŒØ±ÛŒØª (ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡)':'ÙˆØ±ÙˆØ¯ Ù…Ø¯ÛŒØ±ÛŒØª'
}

function readImageFiles(files){
  return new Promise(resolve=>{
    const arr=[];
    let count=0;
    if(!files.length) resolve([]);
    for(let f of files){
      const fr=new FileReader();
      fr.onload=()=>{arr.push(fr.result); count++; if(count===files.length) resolve(arr);}
      fr.readAsDataURL(f);
    }
  })
}

async function addProduct(){
  const t=document.getElementById('pTitle').value;
  const d=document.getElementById('pDesc').value;
  const c=document.getElementById('pCategory').value;
  const p=document.getElementById('pPrice').value;
  const f=document.getElementById('pImages').files;
  const colors=document.getElementById('pColors').value.split(',').map(x=>x.trim()).filter(x=>x);
  const imgs=await readImageFiles(f);
  const l=loadProducts();
  l.unshift({title:t,desc:d,category:c,price:p,images:imgs,colors:colors,createdAt:Date.now()});
  saveProducts(l);applyFilters();alert('Ø¢Ú¯Ù‡ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯')
}

document.getElementById('loginBtn').onclick=showLogin;
document.getElementById('loginPanelBtn').onclick=showLogin;
document.getElementById('logoutBtn').onclick=()=>{setAdminLogged(false);updateAdmin()};
document.getElementById('addProduct').onclick=addProduct;
document.getElementById('search').oninput=applyFilters;
document.getElementById('sort').onchange=applyFilters;
document.getElementById('applyFilter').onclick=applyFilters;
document.getElementById('clearFilter').onclick=()=>{document.getElementById('categoryFilter').value='all';document.getElementById('priceMax').value='';applyFilters()}
updateAdmin();applyFilters();
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyCKORIzuLKqeEDJxibJodGKS23118Dgdig",
  authDomain: "kimia402mezon.firebaseapp.com",
  projectId: "kimia402mezon",
  storageBucket: "kimia402mezon.firebasestorage.app",
  messagingSenderId: "333411485887",
  appId: "1:333411485887:web:f7f8139f343751458f5e0a"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
</script>
</body>
</html>
