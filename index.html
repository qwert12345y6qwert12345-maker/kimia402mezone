<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>مزون کیمیا</title>
  <style>
    body { font-family: sans-serif; direction: rtl; margin: 20px; background:#fafafa; }
    h1 { text-align:center; }
    #ads { display: grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap: 15px; margin-top:20px; }
    .ad { border:1px solid #ddd; padding:10px; border-radius:10px; background:#fff; }
    .hidden { display: none; }
    button { margin-top:10px; padding:6px 12px; }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js"></script>
</head>
<body>
  <h1>مزون کیمیا</h1>

  <div id="adminLogin">
    <input type="password" id="adminPass" placeholder="رمز مدیر">
    <button onclick="login()">ورود مدیر</button>
  </div>

  <div id="adminPanel" class="hidden">
    <h3>افزودن آگهی جدید</h3>
    <input type="text" id="title" placeholder="عنوان"><br>
    <textarea id="desc" placeholder="توضیحات"></textarea><br>
    <input type="text" id="price" placeholder="قیمت"><br>
    <button onclick="addAd()">ذخیره آگهی</button>
  </div>

  <h2>🛍️ آگهی‌ها</h2>
  <div id="ads"></div>

  <script>
    // 🔹 پیکربندی Firebase
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    // شروع
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const adsDiv = document.getElementById("ads");
    const adminPanel = document.getElementById("adminPanel");

    // رمز ورود مدیر
    function login(){
      let pass = document.getElementById("adminPass").value;
      if(pass === "kimia123"){
        adminPanel.classList.remove("hidden");
      } else {
        alert("رمز اشتباه است!");
      }
    }

    // افزودن آگهی
    async function addAd(){
      let title = document.getElementById("title").value;
      let desc = document.getElementById("desc").value;
      let price = document.getElementById("price").value;

      if(!title || !desc || !price){
        alert("همه فیلدها را پر کنید!");
        return;
      }

      await db.collection("ads").add({
        title, desc, price,
        date: new Date().toISOString()
      });

      alert("✅ آگهی ثبت شد!");
      document.getElementById("title").value="";
      document.getElementById("desc").value="";
      document.getElementById("price").value="";
    }

    // نمایش آگهی‌ها به صورت زنده
    db.collection("ads").orderBy("date","desc").onSnapshot(snapshot=>{
      adsDiv.innerHTML = "";
      snapshot.forEach(doc=>{
        let ad = doc.data();
        adsDiv.innerHTML += `
          <div class="ad">
            <h4>${ad.title}</h4>
            <p>${ad.desc}</p>
            <p>💵 ${ad.price} تومان</p>
          </div>
        `;
      });
    });
  </script>
</body>
</html>
